<!--home.wxml-->
<import src="../../common/head.wxml" />
 <import src="../../common/foot.wxml" /> 

<!-- 1：标题模版 -->
<!-- 示例文章：https://api.jiepaiapp.com/app/share.html?articleId=142453&id=1438675&s=9803cf2d8b84b38292b2cd4e5818a69b -->
<template name="article-content-title">
  <view class="article-content-title">
    <text wx:if="{{Text}}" class="article-content-title-txt">{{Text}}</text>
  </view>
</template>

<!-- 2：文本模版 -->
<!-- 示例文章：https://api.jiepaiapp.com/app/share.html?articleId=142453&id=1438675&s=9803cf2d8b84b38292b2cd4e5818a69b -->
<template name="article-content-text">
  <text wx:if="{{Text}}" class="article-content-text">{{Text}}</text>
</template>

<!-- 4：图文模版，带角标图注 -->
<!-- 示例文章：https://api.jiepaiapp.com/app/share.html?articleId=142453&id=1438675&s=9803cf2d8b84b38292b2cd4e5818a69b -->
<template name="article-content-text-image">
  <view wx:if="{{Picture}}" class="article-content-text-image">
    <image wx:if="{{Picture}}" src="{{Picture}}" class="article-content-text-image-img" mode="widthFix" catchtap="onPreviewImg" data-src="{{Picture}}"></image>
    <view wx:if="{{Text}}" class="article-content-text-image-txt-box">
      <image src="../../../images/image_triangle_artical_detail_normal.png" class="article-content-text-image-icon"></image>
      <text wx:if="{{Text}}" class="article-content-text-image-txt">{{Text}}</text>
    </view>
  </view>
</template>

<!-- 5：商品模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-goods">
  <view class="article-content-goods">
    <image wx:if="{{GoodsPicture}}" src="{{GoodsPicture}}" class="article-content-goods-img" mode="widthFix"></image>
    <text wx:if="{{GoodsBrand}}" class="article-content-goods-brand">{{GoodsBrand}}</text>
    <text wx:if="{{GoodsName}}" class="article-content-goods-name">{{GoodsName}}</text>
    <text wx:if="{{Price}}" class="article-content-goods-price">{{Price}}</text>
  </view>
</template>

<!-- 7：GIF图片模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-gif">
  <view style="margin:0 15px 20px;">
    <image wx:if="{{Picture}}" src="{{Picture}}" class="article-content-gif" mode="widthFix" catchtap="onPreviewImg" data-src="{{Picture}}"></image>
  </view>
</template>

<!-- 8：引言模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-quote">
  <view wx:if="{{Text}}" class="article-content-quote">
    <image src="../../../images/image_quota01_normal@2x.png" class="article-content-quote-imgtop"></image>
    <text wx:if="{{Text}}" class="article-content-quote-text">{{Text}}</text>
    <image src="../../../images/image_quota02_normal@2x.png" class="article-content-quote-imgbottom"></image>
  </view>
</template>

<!-- 9：文章模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=138969&id=176&s=ad2a7e9e5e8dfa4788ff7e6b625bc6c4 -->
<template name="article-content-article">
  <view class="article-content-article">
    <image src="{{TitlePicture}}" class="article-content-article-pic"></image>
    <text class="article-content-article-name">{{ColumnName}}</text>
    <text class="article-content-article-title">{{Title}}</text>
    <text class="article-content-article-txt">{{Text}}</text>
  </view>
</template>

<!-- 12：视频模版 -->
<template name="article-content-video">
  <video wx:if="{{VideoLinkLD}}" id="myVideo" src="{{VideoLinkLD}}" controls class="myVideo"></video>
</template>

<!-- 13：小标题模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-sub-title">
  <text wx:if="{{Text}}" class="article-content-sub-title">{{Text}}</text>
</template>

<!-- 18：相册模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-album">
  <view wx:if="{{Picture}}" class="article-content-album">
    <image wx:if="{{Picture}}" src="{{Picture}}" class="article-content-album-img" mode="widthFix" catchtap="onPreviewImg" data-src="{{Picture}}"></image>
    <!-- <text wx:if="{{Text}}" class="article-content-album-text">{{Text}}</text> -->
  </view>
</template>

<!-- 19：第三方视频模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-thirdparty-video">
  <view class="article-content-thirdparty-video">
    <!-- <a class="article-content-thirdparty-video-icon"></a> -->
    <image wx:if="{{Picture}}" src="{{Picture}}" class="article-content-thirdparty-video-img" mode="widthFix"></image>
  </view>
</template>

<!-- 20：投票模版 -->
<!-- 示例文章：https://api.dev.jiepaiapp.com/app/share.html?articleId=139354&id=176&s=5e3bc5cb28024f1b2940463ef456de16 -->
<template name="article-content-vote">
  <!-- <image wx:if="{{Picture && TypeID}}" catchtap="onVoteTap" src="{{Picture}}" data-voteId="{{TypeID}}" class="article-content-vote"></image> -->
  <text wx:if="{{Text && TypeID}}" catchtap="onVoteTap" class="article-content-vote" data-voteId="{{TypeID}}" data-voteflag="{{VoteFlag}}" data-articleid="{{VoteArticleID}}">{{Text}}</text>
</template>

<view class="container">
  <view class="page-body {{isIponeX?'ipone':''}}">
    <!-- 文章标题 -->
    <view wx:if="{{articleTitle}}" class="article-title">{{articleTitle}}</view>
    <!--编辑信息 文章发布时间 大盒子  -->
    <view class="author-createtime-box">
      <view class="author-left">
        <!-- 头像 -->
        <view wx:if="{{author.Avatar}}" class="author-avatar">
          <image wx:if="{{author.Avatar}}" src="{{author.Avatar}}" class="author-avatar-img"></image>
          <image src="../../../images/icon_p_artical_author_normal.png" class="author-avatar-p"></image>
        </view>
        <!-- 编辑昵称、编辑描述 -->
        <view wx:if="{{author.NickName}}" class="author-nickname">
          <text class="author-nickname-name">{{author.NickName}}</text>
          <text class="author-nickname-line">|</text>{{author.Description}}</view>
      </view>
      <!-- 文章发布时间 -->
      <view wx:if="{{createTime}}" class="create-time">{{createTime}}</view>
    </view>

    <!-- 文章内容渲染 -->
    <view wx:if="{{articleInfo.KeyTitle}}" class="articleinfo-keytitle">
      <text class="articleinfo-keytitle-title">{{articleInfo.KeyTitle}}</text>
      <!-- 字体大小：18px -->
      <text class="articleinfo-keytitle-word">{{articleInfo.KeyWord}}</text>
      <!-- 字体大小：24px -->
    </view>

    <block wx:for="{{articleContent}}" wx:for-item="item" wx:key="idx">
      <!-- 标题 -->
      <block wx:if="{{item.Type == 1}}">
        <template is="article-content-title" data="{{...item}}" />
      </block>
      <!-- 文本 -->
      <block wx:elif="{{item.Type == 2}}">
        <template is="article-content-text" data="{{...item}}" />
      </block>
      <!-- 图片 -->
      <block wx:elif="{{item.Type == 4}}">
        <template is="article-content-text-image" data="{{...item}}" />
      </block>
      <!-- 商品 -->
      <block wx:elif="{{item.Type == 5}}">
        <template is="article-content-goods" data="{{...item}}" />
      </block>
      <!-- GIF图片 -->
      <block wx:elif="{{item.Type == 7}}">
        <template is="article-content-gif" data="{{...item}}" />
      </block>
      <!-- 引言 -->
      <block wx:elif="{{item.Type == 8}}">
        <template is="article-content-quote" data="{{...item}}" />
      </block>
      <!-- 文章 -->
      <block wx:elif="{{item.Type == 9}}">
        <template is="article-content-article" data="{{...item}}" />
      </block>
      <!-- 视频 -->
      <block wx:elif="{{item.Type == 12}}">
        <template is="article-content-video" data="{{...item}}" />
      </block>
      <!-- 小标题 -->
      <block wx:elif="{{item.Type == 13}}">
        <template is="article-content-sub-title" data="{{...item}}" />
      </block>
      <!-- 相册 -->
      <block wx:elif="{{item.Type == 18}}">
        <template is="article-content-album" data="{{...item}}" />
      </block>
      <!-- 第三方视频 -->
      <block wx:elif="{{item.Type == 19}}">
        <template is="article-content-thirdparty-video" data="{{...item}}" />
      </block>
      <!-- 投票 -->
      <block wx:elif="{{item.Type == 20}}">
        <template is="article-content-vote" data="{{...item}}" />
      </block>
      <block wx:else>
      </block>
    </block>

    <!-- 热门评论 -->
    <block wx:if="{{dataReady}}">
      <view class="article-comments-line"></view>
      <view class="article-comments-title">评论</view> 
      <block wx:if="{{comments && comments.length!=0}}">
        <block wx:for="{{comments}}" wx:for-item="item" wx:key="idx" wx:for-index="index">
          <block wx:if="{{currentUserId == item.User.UserID}}">
            <view class="article-comments-item">
              <view class="comments-self-left">
                <!-- 发表评论时间 -->
                <text class="comments-self-time">{{item.CreateTime}}</text>
                <text class="comments-self-line">|</text>
                <!-- 回复数量 -->
                <text wx:if="{{item.Statistic.ReplyNum}}" class="comments-self-replyfont">回复</text>
                <text wx:if="{{item.Statistic.ReplyNum}}" class="comments-self-replynum">{{item.Statistic.ReplyNum}}</text>
                <!-- 点赞数量 -->
                <text class="comments-self-praisefont">赞</text>
                <text wx:if="{{item.Statistic.PraiseNum}}" class="comments-self-praisenum">{{item.Statistic.PraiseNum}}</text>
                <!-- 评论内容 -->
                <view wx:if="{{item.Content}}" class="comments-self-content">{{item.Content}}</view>
              </view>
              <view class="comments-self-right">
                <!-- 用户头像 -->
                <image src="{{item.User.Avatar}}" class="comments-self-avatar"></image>
              </view>
            </view>
          </block>
          <block wx:else>
            <view class="article-comments-item">
              <view class="comments-item-otherinfo">
                <view class="comments-item-otherinfo-left">
                  <!-- 用户头像 -->
                  <image src="{{item.User.Avatar}}" class="comments-item-avatar"></image>
                  <!-- 用户昵称 -->
                  <text class="comments-item-nickname">{{item.User.NickName}}</text>
                  <!-- 发表评论时间 -->
                  <text class="comments-item-createtime">{{item.CreateTime}}</text>
                </view>
                <view class="comments-item-otherinfo-right">
                  <!--回复数量-->
                  <text wx:if="{{item.Statistic.ReplyNum}}" class="comments-item-reply">回复<text class="comments-item-replynum">{{item.Statistic.ReplyNum}}</text>|</text>
                  <!--点赞数量 -->
                  <view class="comments-item-praise">
                    <text wx:if="{{item.Statistic.PraiseNum}}" class="comments-item-praisenum">{{item.Statistic.PraiseNum}}</text>
                    <block wx:if="{{item.IsPraise}}">
                      <image src="../../../images/icon_like_comment_checked.png" class="comments-item-praiseicon on"></image>
                    </block>
                    <block wx:else>
                      <image catchtap="onPraiseComment" data-commentid="{{item.CommentID}}" src="../../../images/icon_like_comment_normal.png" class="comments-item-praiseicon"></image>
                    </block>
                  </view>
                </view>
              </view>
              <!-- 评论内容 -->
              <text class="comments-item-content">{{item.Content}}</text>
              <block wx:if="{{item.Pictures && item.Pictures.length>0}}">
                <scroll-view  class="comments-content-image-box" scroll-x="true" style="width:100%;">
                 <image wx:for="{{item.Pictures}}" wx:key="idx" wx:for-item="iitem" src="{{iitem.Picture}}" data-index="{{index}}" data-commentid="{{item.CommentID}}" catchtap="onPreviewPicture" class="comments-item-content-image" style="{{iitem.Ratio == 3 ? 'width:120px;' : ''}}"></image>
                </scroll-view>
              </block>
            </view>
          </block>
          <text wx:if="{{index!=comments.length-1}}" class="comments-item-bottom"></text>
        </block>
      </block>
      <block wx:else>
        <text class="article-comments-nolist">Hehe...坐沙发你是第一个咧！</text>
      </block>
      <!-- <view class="article-comments-app">进入《街拍》APP，参与精彩评论</view> -->
      <form bindsubmit="onGotoAPP" report-submit='true' class="article-comments-app-form {{isIponeX?'iponex':''}}" >
        <button form-type="submit" class="article-comments-app-btn">
          <!-- <image src="../../../images/icon_jinrujiepaipinglun.png" class="article-comments-app-icon"></image> -->
          请前往各大市场下载《街拍》APP，参与精彩评论。
        </button> 
      </form>
    </block>
  </view>
</view>